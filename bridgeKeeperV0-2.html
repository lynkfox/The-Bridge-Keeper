<!doctype html>
<html>
<head>
<title>The Bridge Keeper v0.2</title>
<link rel="stylesheet" type="text/css" href="css/format.css">
<script src="js/jquery-3.3.1.js"></script>



</head>

<body>


<button class="nextButton">Next!</button>


<script>

!function() //IIFE good coding practices. No messy polluted global variables.
{

var arthur=0;
var robin=0;
var lancelot=0;
var isDone=false;
var interlude=0;

/*  question variable values:

0-3 - The question the character is on (or the panel between characters)
8 - Character has been cast into the abyss
10 - Character successfully passes the abyss
15 - reset value.

/*
##dialogueDisAppear (dialogue dissappear / appear)

This function is kinda quick and dirty. It will be used to selectively bring in and out the 'Text Boxes' of the various dialogue and question choices.



todo: modal bootstrap boxes?

Changelog:

removed parameter, combining all three functions together. (IIFE practices)
learned getElementByID is unstable for some browsers, exploring jquery library.
*/



$(document).ready(".nextButton").click(function dialogueDisAppear(){

	var test=nextQuestion();
	
	var divID = checkQuestion(test);
	console.log("Button Click, functions called. divID is: " +divID + ' Test is: ' + test);
	if ($(divID).css('display') === 'none')
	{
		$(divID).css('display', 'block');
	} else
	{
		$(divID).css('display', 'none');
	}
});




/*
## checkQuestion

This function will be used to check what question should be asked, and return the div  name for the box it is in 

Parameters: the count of which question is being asked for which character

todo: change to a switch function.
*/

function checkQuestion(character)
{
	/* Notes for anyone reviewing my code for interview/school purposes:
	
	Today I learned that declaring the variable question, and trying to return that variable, doesn't work in javascript because of block scope. Trying to return var question has no scope outside of the function. It doesn't exist. This is wholly unlike what I am used to in other languages, but it was an important lesson to learn! Hence why I make a note of it.
	let question = '#start'; 
	*/
	
	let whatQuestion=0;
	
	/* Oh. My Goodness. You can see from previous itterations of this code that I was checking character for a numeric value, when it was being passed a string. untyped variables is hard to wrap my head around, but 
	i'm getting there.
	*/
	
	if(character == 'interlude')
	{
		// seperate check function to pull out if the interlude is selected
		if (interlude == 0)
		{
			console.log("Interlude is: " +interlude);
			return '#start';
		}	
		else if (interlude == 1)
		{
			
			
			console.log("Interlude is: " +interlude);
			return '#interlude1';
		}
		else if (interlude == 2)
		{
			
			
			console.log("Interlude is: " +interlude);
			return '#interlude2';
			
		} else if (interlude == 3)
		{
			
			console.log("Interlude is: " +interlude);
			return '#end';
		}
	
	} else if(character == 'lancelot')
	{
		whatQuestion = lancelot;
	} else if (character == 'robin')
	{
		whatQuesteion = robin;
	} else if (character == 'arthur')
	{
		whatQuestion = arthur;
	} else
	{
		return '#error';
	}
	
	
	
	if (whatQuestion == 1)
	{
		console.log("Question is: #name");
		return '#name';
	}
	else if (whatQuestion == 2)
	{
		console.log("Question is: #quest");
		return '#quest';
	}
	else if (whatQuestion == 3)
	{
		console.log("Question is: #color");
		return '#color';
	}
	else if (whatQuestion == 4)
	{
		console.log("Question is: #swallow");
		return '#swallow';
	}
}

/*

## nextQuestion

This function is for the button press. It automatically advances the question track, plus when necessary, advances to the next charcter

It returns the character name (or interlude level) for the question to be asked.
*/

function nextQuestion()
{
	

	if(lancelot < 3)
	{
		
		
		lancelot++;
		console.log("Lancelot Advanced: " +lancelot );
		return 'lancelot';
		
	}
	else if (lancelot ==3 )
	{
		
		// When Lancelot has asked all three questions, incriment him again, and move from Start to Interlude 1 (interlude == 0 to interlude == 1)
		
		// To do : Death check, to set Lancelot == 8 for death, == 10 for success.
		lancelot++;
		interlude++;
		console.log("Lancelot Advanced, Interlude 1: " + lancelot + ", " +interlude );
		return 'interlude';
	}
	else if ( lancelot >3 && robin < 3)
	{
		
		robin++;
		console.log("Robin Advanced: " + robin);
		return 'robin';
	}
	else if (lancelot > 3 && robin == 3)
	{
		
		// Just like the above Lancelot section. moves Robin past the last question, and advances the interlude.
		
		// Again: To Do: death check.
		robin++;
		interlude++;
		console.log("Robin Advanced, Interlude 2: " + robin + ", " + interlude);
		return 'interlude';
	}
	else if (lancelot >3 && robin >3 && arthur<3)
	{
		// To do: Arthur Question 4 (Swallow)
		
		arthur++;
		console.log("Arthur Advanced: " + arthur);
		return 'arthur';
	}
	else if (lancelot >3 && robin >3 && arthur>2 && interlude >2)
	{
		
		// Reset branch: Should be called when all questions are asked, reseting to the base.
		arthur = 0;
		robin = 0;
		lancelot=0;
		interlude=0;
		console.log("Reset: " +arthur + robin + lancelot + interlude);	
		return 'start';
	}
	else
	{
		
		interlude++;
		console.log("No charcter advance, Interlude Advanced: " +interlude);
		return 'interlude';
		
	}

}

}();
/*

# old code: to be removed for final v2 (CSS Elements). Kept at this point for reference



alert("First Lancelot arrives 'Ask your questions Bridge Keeper, I'm not afraid'. The Bridge Keeper grins a crazy smile. 'Answer me these Questions three, else the other side you shall not see!' says the Bridge Keeper.");
while(!isDone) //When all three have answered 3 questions the test is over
{
//Ask the 3 questions for Lancelot, skipping the first one cause whatever
while(lancelot<3)
{
	if(questionNumber == 0)
		{
			prompt(questions[questionNumber][0], "");
			questionNumber++;
			lancelot++;
			console.log('Lancelot Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
		} 
	else
		{
			answers = prompt(questions[questionNumber][0],"").toLowerCase();
			console.log('Lancelot ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
			if (answers != questions[questionNumber][1])
				{
					alert("Wrong! You are tossed into the abyss. Next up, Robin!")
					lancelot = 10;
					questionNumber = 0;
					console.log('Lancelot: ' +lancelot+ ' and ?# ' +questionNumber);
				}
			else
				{
					questionNumber++;
					lancelot++;
					console.log('Lancelot: ' +lancelot+ ' and ?# ' +questionNumber);
					let answers = null; //cleanup
				}
		}
}

while (lancelot>=2 && robin<3)
{
	if(lancelot==3 && robin==0)
		{
			alert('" Right, off you go" the Bridge keeper says to Lancelot. He blinks and passes the bridge. "That was easy!" Robin exclaims, running up to the bridge keeper."');
			lancelot = 8; //(to remove this from follow up loops. 
			questionNumber=0; //reset the question number
			console.log('Lancelot Success');
			console.log('Robin Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			

		} else if (lancelot==10 && robin == 0)
			{
				alert('Uhoh. Something isnt going right... Robin comes up to the Bridge Keeper')
				lancelot = 8; //(to remove this from follow up loops. 
				console.log('Lancelot Fail');
				console.log('Robin Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
				
			}
	if(questionNumber==0)
		{
			prompt(questions[questionNumber][0], "");
			questionNumber++;
			robin++;
			console.log('Robin Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
		}
	else
		{
			answers = prompt(questions[questionNumber][0],"").toLowerCase();
			if (answers != questions[questionNumber][1] || answers == 'blue')
				{
					if(questionNumber ==2)
					{
						alert("'No wait, Yellow!' Robin screams as he is tossed into the abyss'");
						robin = 10; // set robin to 'Dead'
						questionNumber = 0; // reset the question number
						console.log('Robin Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
					} else
					{
						alert("Robin is tossed into the abyss!... King Arthur is up next...");
						robin = 10;
						questionNumber=0;
						console.log('Arthur Question (not Color fail) ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
					}
				}
			else
				{
					questionNumber++; 
					robin++;
					console.log('Robin Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
					let answers = null; //cleanup
				}
		}
}

while (lancelot>=2 && robin>=3 && arthur<3)
	{
		if(robin==10 && arthur==0)
		{
			alert('Finally, King Arthur with a worried look arrives.');
			robin = 15; //(to remove this from follow up loops. 
			questionNumber=0; //reset the question number.
			console.log('Robin fail');
			console.log('Arthur Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
		}
		else if(robin == 3 && arthur == 0)
			{
				alert('Amazingly, Robin made it past. King Arthur comes up confidently to the Bridge Keeper')
				robin = 8;
				questionNumber=0;
				console.log('Robin Success');
				console.log('Arthur Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
			}
		if(questionNumber==0)
			{
				console.log('Arthur Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
				prompt(questions[questionNumber][0], "");
				questionNumber=1;
				console.log('Arthur Question# in first question increase: ' +questionNumber);
				arthur++;
				console.log('Arthur Question ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			}
		else
			{ console.log('Arthur Question ' +questionNumber+ 'lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ 'current Question: ' + (questions[questionNumber][0]) + ' and answer: ' + (questions[questionNumber][1]) );
				answers = prompt(questions[questionNumber][0], "").toLowerCase();
				if (answers != questions[questionNumber][1])
					{
						alert("Wrong! You are tossed into the abyss.")
						arthur = 10 // set arthur to 'Dead'
						questionNumber = 0 // reset the question number
						console.log('Arthur Question Fail ' +questionNumber+ ' lancelot='+lancelot+ ' robin='+robin+ ' arthur='+arthur+ ' current Question: ' + questions[questionNumber][0] + ' and answer: ' + questions[questionNumber][1]); 
			
						
					}
				else
					{
					
					
					questionNumber++; 
			
						if(questionNumber==2)
						{
							questionNumber++; // Skip to the different 3rd question for Arthur
							console.log('Arthur Question# skip to 3rd question: question number: ' +questionNumber);
							
						
						}
					arthur++;
					
			
					let answers = null; //cleanup
					}
			}
		if (questionNumber==4) // This. RIght here. I was trying to debug why it kept erroring out on Question 2 of King Arthur... and this was questionNumber=4 not ==4. Of course it was. 
			{
				isDone=true;
			}
	}
}

if(arthur != 10)
{
alert("'I... I don't know?' the Bridge Keeper cries as he is flung into the abyss.");
			
}
else
{
alert("Oh dear. You failed quest for the Holy Grail");
			
}

*/



</script>

<div id="start"> <p>"The Knights of Camelot approach the Bridge Keeper. He guards the only path across this chasm, on their quest for the Holy Grail. They have been warned about this challenge, and approach warrily. First, Lancelot approaches the Bridge Keeper. </p>

<p>The Bridge Keeper grins a crooked crazy smile. " Stop! Who would cross the Bridge of Death must answer me these questions three, ere the other side he see."</p>

<p>"Ask me the questions, bridgekeeper. I am not afraid." Lancelot replies...</p>
</div>
<div id="name"><p>"What... is your name?"</p></div><div id="quest"><p>"What... is your quest?"</p></div><div id="color"><p>"What... is your favorite color?"</p></div><div id="swallow"><p>"What... is the air-speed velocity of an unladen swallow?"</p></div>
<div id="interlude1"><p>Lancelot, surprised, passes the Gorge of Eternal Peril via the Bridge of Death, dissapearing into the fog.</p>

<p>Robin, blinks. "That's Easy!" he explains and walks up to the Bridge Keeper.</p>

<p>"Stop! Who approacheth the Bridge of Death must answer me these questions three, ere the other side he see." The Bridge Keeper says.</p>

<p>"Ask me the questions, bridgekeeper. I am not afraid." Robin replies...</p></div>
<div id="interlude2"><p>"No wait, Yellow!" Robin screams as he is cast from the Bridge of Death into the Gorge of Eternal Peril. The Bridgekeeper laughs.</p>

<p> Worried, King Arthur approaches. "Stop! Who approacheth the Bridge of Death must answer me these questions three, ere the other side he see." The Bridge Keeper says.</p></div>
<div id="end"><p>The Quest for the Holy Grail continues, though perhaps with a few less Knights...</p></div>


</body>

</html>